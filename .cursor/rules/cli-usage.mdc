# CLI Usage Guide

This guide covers the ts-for-gir CLI commands for generating TypeScript type definitions from GIR files.

## Quick Start

### Generate Types
```bash
# Generate specific module
yarn ts-for-gir-dev generate Gtk-4.0

# Generate multiple modules with reporter enabled
yarn ts-for-gir-dev generate Gtk-4.0 Gio-2.0 --reporter --reporterOutput=./debug-report.json
```

### Debug & Error Analysis (AI-Optimized)
```bash
# CRITICAL FOR AI AGENTS: Use analyze command to debug type generation issues
yarn ts-for-gir-dev analyze -f ./ts-for-gir-report.json

# Show only critical errors and type resolution failures
yarn ts-for-gir-dev analyze -f ./report.json --severity critical error --category type_resolution

# Export specific problems for detailed AI analysis
yarn ts-for-gir-dev analyze -f ./report.json --search "Unable to resolve" --export unresolved-types.json

# Find problems in specific namespaces/modules
yarn ts-for-gir-dev analyze -f ./report.json --namespace Gtk --format table

# Analyze specific problematic types
yarn ts-for-gir-dev analyze -f ./report.json --type time_t gpointer --format json
```

### List Available Modules
```bash
yarn ts-for-gir-dev list
```

## AI Error Detection Workflow

**Step 1: Generate with Reporter**
Always enable the reporter when generating types to capture detailed problem information:
```bash
yarn ts-for-gir-dev generate [modules] --reporter --verbose
```

**Step 2: Analyze Report File**
Use the analyze command to identify patterns and specific issues:
```bash
# Quick overview of all problems
yarn ts-for-gir-dev analyze -f ./ts-for-gir-report.json

# Focus on critical issues only
yarn ts-for-gir-dev analyze -f ./ts-for-gir-report.json --severity critical error --top 20

# Export problematic types for AI processing
yarn ts-for-gir-dev analyze -f ./ts-for-gir-report.json --category type_resolution --export type-issues.json
```

**Step 3: Pattern Analysis**
Use the analyze command's filtering capabilities to identify systematic issues:

```bash
# Find all type resolution failures
yarn ts-for-gir-dev analyze -f ./report.json --category type_resolution --format table

# Identify most problematic namespaces
yarn ts-for-gir-dev analyze -f ./report.json --top 10 --format json

# Search for specific error patterns
yarn ts-for-gir-dev analyze -f ./report.json --search "Unable to resolve" --format table
```

## Advanced Analysis Commands

### Filtering by Severity
```bash
# Show only critical and error level issues
yarn ts-for-gir-dev analyze -f ./report.json --severity critical error

# Focus on warnings and info for optimization
yarn ts-for-gir-dev analyze -f ./report.json --severity warning info
```

### Filtering by Category
```bash
# Type resolution issues
yarn ts-for-gir-dev analyze -f ./report.json --category type_resolution

# Template generation problems
yarn ts-for-gir-dev analyze -f ./report.json --category template_generation

# GIR parsing errors
yarn ts-for-gir-dev analyze -f ./report.json --category gir_parsing
```

### Search and Export
```bash
# Search for specific error messages
yarn ts-for-gir-dev analyze -f ./report.json --search "Unable to resolve"

# Export filtered results to JSON for further analysis
yarn ts-for-gir-dev analyze -f ./report.json --severity critical --export critical-issues.json

# Export specific namespace issues
yarn ts-for-gir-dev analyze -f ./report.json --namespace Gtk --export gtk-issues.json
```

### Output Formats
```bash
# Table format for human reading
yarn ts-for-gir-dev analyze -f ./report.json --format table

# JSON format for programmatic processing
yarn ts-for-gir-dev analyze -f ./report.json --format json

# Summary format for quick overview
yarn ts-for-gir-dev analyze -f ./report.json --format summary
```

## Configuration Examples

### Basic Configuration
```javascript
// .ts-for-gir.rc.js
export default {
	modules: ['Gtk-4.0', 'Gio-2.0'],
	outdir: './types',
	reporter: true,
	reporterOutput: './ts-for-gir-report.json'
};
```

**Useful Analyze Command Combinations for AI:**
```bash
# Get overview statistics
yarn ts-for-gir-dev analyze -f ./report.json --format summary

# Export all critical issues as JSON for programmatic analysis
yarn ts-for-gir-dev analyze -f ./report.json --severity critical --format json --export critical-issues.json

# Find all unresolved types across modules
yarn ts-for-gir-dev analyze -f ./report.json --search "Unable to resolve" --format table

# Analyze top problematic namespaces
yarn ts-for-gir-dev analyze -f ./report.json --top 10 --format json
```

## Generation Targets

### Output Directories
- **`./types` (Default)**: Standard output directory
- **`./test-types-*`**: Development/testing output
- **Custom paths**: Use `--outdir` flag

### Module Selection
- **Single module**: `yarn ts-for-gir-dev generate Gtk-4.0`
- **Multiple modules**: `yarn ts-for-gir-dev generate Gtk-4.0 Gio-2.0`
- **All available**: `yarn ts-for-gir-dev generate --all`

## Troubleshooting

### Common Issues
1. **Module not found**: Use `yarn ts-for-gir-dev list` to see available modules
2. **Type resolution errors**: Use reporter and analyze commands for detailed debugging
3. **Template errors**: Check template syntax and override configurations

### Debug Mode
```bash
# Enable verbose output
yarn ts-for-gir-dev generate Gtk-4.0 --verbose

# Generate with detailed reporter
yarn ts-for-gir-dev generate Gtk-4.0 --reporter --reporterOutput=./debug.json
```

## Best Practices

1. **Always use reporter** during development to capture issues
2. **Analyze reports regularly** to identify patterns
3. **Use specific filters** to focus on relevant problems
4. **Export results** for further analysis and tracking
5. **Test with multiple modules** to ensure compatibility
## Workspace Integration
After generation:
1. Run `yarn install` to link generated packages
2. Import with `import Gtk from 'gi://Gtk?version=4.0'`
3. Use `@girs/*` packages in examples